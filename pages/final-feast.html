<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–ü—Ä–∞–∑–¥–Ω–∏—á–Ω—ã–π —Å—Ç–æ–ª - –¢–∞—Ç–∞—Ä—Å–∫–∏–π –º–∞—Å—Ç–µ—Ä-–∫–ª–∞—Å—Å</title>
    <link rel="stylesheet" href="../styles/main.css">
    <style>
        .feast-container {
            text-align: center;
            padding: 20px;
        }

        .dining-table {
            width: 100%;
            max-width: 800px;
            height: 500px;
            background: linear-gradient(145deg, #8b4513, #a0522d);
            border-radius: 20px;
            margin: 30px auto;
            position: relative;
            border: 5px solid #654321;
            box-shadow: 0 10px 30px rgba(0,0,0,0.3);
        }

        .table-surface {
            position: absolute;
            top: 20px;
            left: 20px;
            right: 20px;
            bottom: 20px;
            background: linear-gradient(145deg, #deb887, #d2b48c);
            border-radius: 15px;
            overflow: hidden;
        }

        .dish-placement {
            position: absolute;
            cursor: pointer;
            transition: all 0.3s ease;
            opacity: 0;
            transform: scale(0);
        }

        .dish-placement.visible {
            opacity: 1;
            transform: scale(1);
            animation: dishAppear 0.8s ease-out;
        }

        @keyframes dishAppear {
            0% { opacity: 0; transform: scale(0) rotate(-180deg); }
            50% { opacity: 0.5; transform: scale(1.2) rotate(-90deg); }
            100% { opacity: 1; transform: scale(1) rotate(0deg); }
        }

        .dish-placement:hover {
            transform: scale(1.1);
            z-index: 10;
        }

        .echpochmak-dish {
            top: 20%;
            left: 15%;
            width: 120px;
            height: 120px;
            background: linear-gradient(145deg, #f39c12, #e67e22);
            border-radius: 50%;
            border: 3px solid #d35400;
        }

        .echpochmak-dish::before {
            content: 'ü•üü•üü•ü';
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            font-size: 1.5rem;
        }

        .kystybyi-dish {
            top: 20%;
            right: 15%;
            width: 120px;
            height: 120px;
            background: linear-gradient(145deg, #fdcb6e, #f39c12);
            border-radius: 50%;
            border: 3px solid #e67e22;
        }

        .kystybyi-dish::before {
            content: 'ü´ìü´ìü´ì';
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            font-size: 1.5rem;
        }

        .chak-chak-dish {
            bottom: 20%;
            left: 50%;
            transform: translateX(-50%);
            width: 140px;
            height: 100px;
            background: linear-gradient(145deg, #e17055, #d63031);
            border-radius: 20px;
            border: 3px solid #b71c1c;
        }

        .chak-chak-dish::before {
            content: 'üçØ';
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            font-size: 2rem;
        }

        .tea-service {
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            width: 200px;
            height: 150px;
            background: linear-gradient(145deg, #74b9ff, #0984e3);
            border-radius: 15px;
            border: 3px solid #0056b3;
        }

        .tea-service::before {
            content: 'ü´ñ‚òï‚òï‚òï';
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            font-size: 1.2rem;
        }

        .family-gathering {
            display: flex;
            justify-content: space-around;
            margin: 40px 0;
            flex-wrap: wrap;
        }

        .family-member {
            text-align: center;
            margin: 10px;
            padding: 20px;
            background: linear-gradient(145deg, #f8f9fa, #e9ecef);
            border-radius: 15px;
            border: 2px solid #ddd;
            transition: all 0.3s ease;
            cursor: pointer;
        }

        .family-member:hover {
            transform: scale(1.05);
            background: linear-gradient(145deg, #fff3cd, #ffeaa7);
        }

        .family-member.happy {
            background: linear-gradient(145deg, #d4edda, #c3e6cb);
            border-color: #28a745;
        }

        .member-avatar {
            font-size: 3rem;
            margin-bottom: 10px;
        }

        .member-name {
            font-weight: bold;
            margin-bottom: 5px;
        }

        .member-reaction {
            font-style: italic;
            color: #666;
            min-height: 40px;
        }

        .celebration-effects {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: 1000;
        }

        .confetti {
            position: absolute;
            font-size: 2rem;
            animation: confettiFall 3s linear infinite;
        }

        @keyframes confettiFall {
            0% { transform: translateY(-100vh) rotate(0deg); opacity: 1; }
            100% { transform: translateY(100vh) rotate(360deg); opacity: 0; }
        }

        .achievement-popup {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: linear-gradient(145deg, #ffd700, #ffed4e);
            padding: 30px;
            border-radius: 20px;
            border: 3px solid #f39c12;
            text-align: center;
            z-index: 1001;
            display: none;
            box-shadow: 0 10px 30px rgba(0,0,0,0.3);
        }

        .achievement-popup.visible {
            display: block;
            animation: achievementPop 2s ease-out;
        }

        @keyframes achievementPop {
            0% { transform: translate(-50%, -50%) scale(0); opacity: 0; }
            50% { transform: translate(-50%, -50%) scale(1.2); opacity: 1; }
            100% { transform: translate(-50%, -50%) scale(1); opacity: 1; }
        }

        .cooking-stats {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin: 30px 0;
        }

        .stat-card {
            background: linear-gradient(145deg, #f8f9fa, #e9ecef);
            border-radius: 15px;
            padding: 20px;
            text-align: center;
            border: 2px solid #ddd;
        }

        .stat-icon {
            font-size: 2rem;
            margin-bottom: 10px;
        }

        .stat-value {
            font-size: 1.5rem;
            font-weight: bold;
            color: #e67e22;
        }

        .final-message {
            background: linear-gradient(145deg, #d4edda, #c3e6cb);
            border-radius: 15px;
            padding: 30px;
            margin: 30px 0;
            border: 3px solid #28a745;
        }

        @media (max-width: 768px) {
            .dining-table {
                height: 400px;
            }
            
            .family-gathering {
                flex-direction: column;
                align-items: center;
            }
        }
    </style>
</head>
<body>
    <div class="game-container">
        <div class="game-screen">
            <h1 class="screen-title">üçΩÔ∏è –ü—Ä–∞–∑–¥–Ω–∏—á–Ω—ã–π —Ç–∞—Ç–∞—Ä—Å–∫–∏–π —Å—Ç–æ–ª</h1>
            
            <div class="character-dialog">
                <div class="character-avatar">üëµüèª</div>
                <div class="dialog-text">
                    <p><strong>–ë–∞–±—É—à–∫–∞ –§–∞—Ç–∏–º–∞:</strong></p>
                    <p id="dialog-text">–¢–µ–ø–µ—Ä—å —Ä–∞—Å—Å—Ç–∞–≤–∏–º –≤—Å–µ –±–ª—é–¥–∞ –Ω–∞ —Å—Ç–æ–ª! –ù–∞–∂–∏–º–∞–π –Ω–∞ –∫–∞–∂–¥–æ–µ –±–ª—é–¥–æ, —á—Ç–æ–±—ã –ø–æ—Å—Ç–∞–≤–∏—Ç—å –µ–≥–æ –Ω–∞ —Å—Ç–æ–ª.</p>
                </div>
            </div>

            <div class="feast-container">
                <div class="dining-table">
                    <div class="table-surface">
                        <div class="dish-placement echpochmak-dish" id="echpochmak-spot" onclick="placeDish('echpochmak')"></div>
                        <div class="dish-placement kystybyi-dish" id="kystybyi-spot" onclick="placeDish('kystybyi')"></div>
                        <div class="dish-placement chak-chak-dish" id="chak-chak-spot" onclick="placeDish('chak-chak')"></div>
                        <div class="dish-placement tea-service" id="tea-spot" onclick="placeDish('tea')"></div>
                    </div>
                </div>

                <div class="cooking-stats">
                    <div class="stat-card">
                        <div class="stat-icon">ü•ü</div>
                        <div>–≠—á–ø–æ—á–º–∞–∫–æ–≤</div>
                        <div class="stat-value">12 —à—Ç—É–∫</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-icon">ü´ì</div>
                        <div>–ö—ã—Å—Ç—ã–±—ã–µ–≤</div>
                        <div class="stat-value">8 —à—Ç—É–∫</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-icon">üçØ</div>
                        <div>–ß–∞–∫-—á–∞–∫–∞</div>
                        <div class="stat-value">1 –±–ª—é–¥–æ</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-icon">ü´ñ</div>
                        <div>–ß–∞—è</div>
                        <div class="stat-value">4 —á–∞—à–∫–∏</div>
                    </div>
                </div>

                <div class="family-gathering">
                    <div class="family-member" id="grandpa" onclick="interactWithFamily('grandpa')">
                        <div class="member-avatar">üë¥üèª</div>
                        <div class="member-name">–î–µ–¥—É—à–∫–∞ –ê—Ö–º–µ—Ç</div>
                        <div class="member-reaction" id="grandpa-reaction">–ñ–¥—ë—Ç —É–≥–æ—â–µ–Ω–∏—è...</div>
                    </div>
                    <div class="family-member" id="aunt" onclick="interactWithFamily('aunt')">
                        <div class="member-avatar">üë©üèª</div>
                        <div class="member-name">–¢—ë—Ç—è –ì—É–ª—å–Ω–∞—Ä–∞</div>
                        <div class="member-reaction" id="aunt-reaction">–í–æ—Å—Ö–∏—â–∞–µ—Ç—Å—è –∞—Ä–æ–º–∞—Ç–æ–º...</div>
                    </div>
                    <div class="family-member" id="brother" onclick="interactWithFamily('brother')">
                        <div class="member-avatar">üë¶üèª</div>
                        <div class="member-name">–ë—Ä–∞—Ç–∏–∫ –¢–∏–º—É—Ä</div>
                        <div class="member-reaction" id="brother-reaction">–•–æ—á–µ—Ç –ø–æ–ø—Ä–æ–±–æ–≤–∞—Ç—å —á–∞–∫-—á–∞–∫...</div>
                    </div>
                    <div class="family-member" id="grandma" onclick="interactWithFamily('grandma')">
                        <div class="member-avatar">üëµüèª</div>
                        <div class="member-name">–ë–∞–±—É—à–∫–∞ –§–∞—Ç–∏–º–∞</div>
                        <div class="member-reaction" id="grandma-reaction">–ì–æ—Ä–¥–∏—Ç—Å—è —Ç–≤–æ–∏–º–∏ —É—Å–ø–µ—Ö–∞–º–∏!</div>
                    </div>
                </div>

                <div class="final-message" id="final-message" style="display: none;">
                    <h2>üéâ –ü–æ–∑–¥—Ä–∞–≤–ª—è–µ–º!</h2>
                    <p>–¢—ã —É—Å–ø–µ—à–Ω–æ –ø—Ä–∏–≥–æ—Ç–æ–≤–∏–ª —Ç—Ä–∞–¥–∏—Ü–∏–æ–Ω–Ω—ã–π —Ç–∞—Ç–∞—Ä—Å–∫–∏–π –æ–±–µ–¥! –°–µ–º—å—è –≤ –≤–æ—Å—Ç–æ—Ä–≥–µ –æ—Ç —Ç–≤–æ–∏—Ö –∫—É–ª–∏–Ω–∞—Ä–Ω—ã—Ö —Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç–µ–π.</p>
                    <p><strong>–¢—ã –∏–∑—É—á–∏–ª:</strong></p>
                    <ul style="text-align: left; max-width: 400px; margin: 0 auto;">
                        <li>ü•ü –ö–∞–∫ –≥–æ—Ç–æ–≤–∏—Ç—å —ç—á–ø–æ—á–º–∞–∫ —Å –º—è—Å–Ω–æ–π –Ω–∞—á–∏–Ω–∫–æ–π</li>
                        <li>ü´ì –°–µ–∫—Ä–µ—Ç—ã –ø—Ä–∏–≥–æ—Ç–æ–≤–ª–µ–Ω–∏—è –∫—ã—Å—Ç—ã–±—ã—è</li>
                        <li>üçØ –¢—Ä–∞–¥–∏—Ü–∏–æ–Ω–Ω—ã–π —Ä–µ—Ü–µ–ø—Ç —á–∞–∫-—á–∞–∫–∞</li>
                        <li>ü´ñ –ò—Å–∫—É—Å—Å—Ç–≤–æ —Ç–∞—Ç–∞—Ä—Å–∫–æ–π —á–∞–π–Ω–æ–π —Ü–µ—Ä–µ–º–æ–Ω–∏–∏</li>
                    </ul>
                    <p><em>–¢–µ–ø–µ—Ä—å —Ç—ã –Ω–∞—Å—Ç–æ—è—â–∏–π –º–∞—Å—Ç–µ—Ä —Ç–∞—Ç–∞—Ä—Å–∫–æ–π –∫—É—Ö–Ω–∏!</em></p>
                </div>
            </div>

            <div class="dialog-controls">
                <button class="back-button" onclick="goBack()">–ù–∞–∑–∞–¥</button>
                <button class="next-button" id="restart-button" onclick="restartGame()" style="display: none;">–ù–∞—á–∞—Ç—å –∑–∞–Ω–æ–≤–æ</button>
            </div>

            <div class="progress-bar">
                <div class="progress-fill" style="width: 100%;"></div>
            </div>
        </div>
    </div>

    <div class="celebration-effects" id="celebration-effects"></div>
    
    <div class="achievement-popup" id="achievement-popup">
        <h2>üèÜ –î–æ—Å—Ç–∏–∂–µ–Ω–∏–µ —Ä–∞–∑–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–æ!</h2>
        <p id="achievement-text">–ú–∞—Å—Ç–µ—Ä —Ç–∞—Ç–∞—Ä—Å–∫–æ–π –∫—É—Ö–Ω–∏</p>
    </div>
    
    <script src="../scripts/main.js"></script>
    <script>
        let dishesPlaced = 0;
        let familyInteractions = 0;
        const totalDishes = 4;
        const totalFamily = 4;
        
        const familyReactions = {
            grandpa: [
                "–ú–º–º, –∫–∞–∫ –≤–∫—É—Å–Ω–æ –ø–∞—Ö–Ω–µ—Ç!",
                "–≠—á–ø–æ—á–º–∞–∫ –ø—Ä–æ—Å—Ç–æ –≤–µ–ª–∏–∫–æ–ª–µ–ø–µ–Ω!",
                "–°–ø–∞—Å–∏–±–æ –∑–∞ —É–≥–æ—â–µ–Ω–∏–µ, –≤–Ω—É—á–µ–∫!"
            ],
            aunt: [
                "–ö–∞–∫–æ–π –∞—Ä–æ–º–∞—Ç–Ω—ã–π —á–∞–π!",
                "–ö—ã—Å—Ç—ã–±—ã–π –ø–æ–ª—É—á–∏–ª—Å—è –æ—Ç–ª–∏—á–Ω—ã–π!",
                "–¢—ã –Ω–∞—Å—Ç–æ—è—â–∏–π –ø–æ–≤–∞—Ä!"
            ],
            brother: [
                "–ú–æ–∂–Ω–æ –µ—â—ë —á–∞–∫-—á–∞–∫–∞?",
                "–≠—Ç–æ —Å–∞–º—ã–π –≤–∫—É—Å–Ω—ã–π –æ–±–µ–¥!",
                "–ù–∞—É—á–∏ –º–µ–Ω—è –≥–æ—Ç–æ–≤–∏—Ç—å!"
            ],
            grandma: [
                "–Ø —Ç–∞–∫ –≥–æ—Ä–∂—É—Å—å —Ç–æ–±–æ–π!",
                "–¢—ã –ø—Ä–µ–≤–∑–æ—à—ë–ª –≤—Å–µ –æ–∂–∏–¥–∞–Ω–∏—è!",
                "–¢–µ–ø–µ—Ä—å —Ç—ã –∑–Ω–∞–µ—à—å –Ω–∞—à–∏ —Å–µ–º–µ–π–Ω—ã–µ —Ä–µ—Ü–µ–ø—Ç—ã!"
            ]
        };
        
        function placeDish(dishType) {
            const dishElement = document.getElementById(dishType + '-spot');
            if (dishElement.classList.contains('visible')) return;
            
            dishElement.classList.add('visible');
            dishesPlaced++;
            
            const dishNames = {
                'echpochmak': '—ç—á–ø–æ—á–º–∞–∫',
                'kystybyi': '–∫—ã—Å—Ç—ã–±—ã–π', 
                'chak-chak': '—á–∞–∫-—á–∞–∫',
                'tea': '—á–∞–π–Ω—ã–π —Å–µ—Ä–≤–∏–∑'
            };
            
            document.getElementById('dialog-text').textContent = 
                `${dishNames[dishType]} –ø–æ—Å—Ç–∞–≤–ª–µ–Ω –Ω–∞ —Å—Ç–æ–ª! ${dishesPlaced}/${totalDishes}`;
            
            if (dishesPlaced >= totalDishes) {
                setTimeout(() => {
                    completeTableSetting();
                }, 1000);
            }
            
            playSound('place');
        }
        
        function completeTableSetting() {
            document.getElementById('dialog-text').textContent = 
                '–°—Ç–æ–ª –Ω–∞–∫—Ä—ã—Ç! –¢–µ–ø–µ—Ä—å –ø–æ–æ–±—â–∞–π—Å—è —Å –∫–∞–∂–¥—ã–º —á–ª–µ–Ω–æ–º —Å–µ–º—å–∏.';
            
            showSuccessMessage('–í—Å–µ –±–ª—é–¥–∞ –Ω–∞ —Å—Ç–æ–ª–µ!');
        }
        
        function interactWithFamily(member) {
            const memberElement = document.getElementById(member);
            const reactionElement = document.getElementById(member + '-reaction');
            
            if (memberElement.classList.contains('happy')) return;
            
            memberElement.classList.add('happy');
            familyInteractions++;
            
            const reactions = familyReactions[member];
            const randomReaction = reactions[Math.floor(Math.random() * reactions.length)];
            reactionElement.textContent = randomReaction;
            
            if (familyInteractions >= totalFamily) {
                setTimeout(() => {
                    completeFeast();
                }, 1500);
            }
            
            playSound('happy');
        }
        
        function completeFeast() {
            // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –∫–æ–Ω—Ñ–µ—Ç—Ç–∏
            createConfetti();
            
            // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–µ
            setTimeout(() => {
                showAchievement();
            }, 1000);
            
            // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —Ñ–∏–Ω–∞–ª—å–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ
            setTimeout(() => {
                document.getElementById('final-message').style.display = 'block';
                document.getElementById('restart-button').style.display = 'block';
                
                document.getElementById('dialog-text').textContent = 
                    '–ü–æ–∑–¥—Ä–∞–≤–ª—è—é! –¢—ã —Å—Ç–∞–ª –Ω–∞—Å—Ç–æ—è—â–∏–º –º–∞—Å—Ç–µ—Ä–æ–º —Ç–∞—Ç–∞—Ä—Å–∫–æ–π –∫—É—Ö–Ω–∏!';
            }, 3000);
        }
        
        function createConfetti() {
            const effects = document.getElementById('celebration-effects');
            const confettiSymbols = ['üéâ', 'üéä', '‚≠ê', 'üåü', '‚ú®', 'üéà'];
            
            for (let i = 0; i < 20; i++) {
                setTimeout(() => {
                    const confetti = document.createElement('div');
                    confetti.className = 'confetti';
                    confetti.textContent = confettiSymbols[Math.floor(Math.random() * confettiSymbols.length)];
                    confetti.style.left = Math.random() * 100 + '%';
                    confetti.style.animationDelay = Math.random() * 2 + 's';
                    confetti.style.animationDuration = (Math.random() * 2 + 3) + 's';
                    
                    effects.appendChild(confetti);
                    
                    setTimeout(() => {
                        confetti.remove();
                    }, 5000);
                }, i * 100);
            }
        }
        
        function showAchievement() {
            const popup = document.getElementById('achievement-popup');
            popup.classList.add('visible');
            
            setTimeout(() => {
                popup.classList.remove('visible');
            }, 3000);
            
            playSound('achievement');
        }
        
        function goBack() {
            window.location.href = '../pages/tatar-tea-prep.html';
        }
        
        function restartGame() {
            window.location.href = '../index.html';
        }
        
        // –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –Ω–∞—á–∏–Ω–∞–µ–º —Ä–∞–∑–º–µ—â–µ–Ω–∏–µ –±–ª—é–¥ —á–µ—Ä–µ–∑ 2 —Å–µ–∫—É–Ω–¥—ã
        setTimeout(() => {
            document.getElementById('dialog-text').textContent = 
                '–ù–∞–∂–∏–º–∞–π –Ω–∞ –º–µ—Å—Ç–∞ –Ω–∞ —Å—Ç–æ–ª–µ, —á—Ç–æ–±—ã —Ä–∞—Å—Å—Ç–∞–≤–∏—Ç—å –±–ª—é–¥–∞!';
        }, 2000);
    </script>
</body>
</html>