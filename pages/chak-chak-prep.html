<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–ß–∞–∫-—á–∞–∫: –ü—Ä–∏–≥–æ—Ç–æ–≤–ª–µ–Ω–∏–µ - –¢–∞—Ç–∞—Ä—Å–∫–∏–π –º–∞—Å—Ç–µ—Ä-–∫–ª–∞—Å—Å</title>
    <link rel="stylesheet" href="../styles/main.css">
    <style>
        .chak-chak-stages {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 30px;
            margin: 30px 0;
        }

        .stage-panel {
            background: linear-gradient(145deg, #f8f9fa, #e9ecef);
            border-radius: 15px;
            padding: 20px;
            min-height: 400px;
        }

        .stage-panel.active {
            border: 3px solid #f39c12;
            background: linear-gradient(145deg, #fff3cd, #ffeaa7);
        }

        .dough-preparation {
            text-align: center;
        }

        .egg-cracking {
            margin: 20px 0;
        }

        .egg {
            width: 60px;
            height: 80px;
            background: linear-gradient(145deg, #fff, #f8f9fa);
            border-radius: 30px 30px 40px 40px;
            margin: 10px;
            cursor: pointer;
            transition: all 0.3s ease;
            display: inline-block;
            position: relative;
        }

        .egg:hover {
            transform: scale(1.1);
        }

        .egg.cracked {
            background: linear-gradient(145deg, #fdcb6e, #f39c12);
            cursor: not-allowed;
        }

        .egg.cracked::after {
            content: 'ü•ö';
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            font-size: 1.5rem;
        }

        .mixing-bowl-chak {
            width: 180px;
            height: 120px;
            background: linear-gradient(145deg, #e9ecef, #dee2e6);
            border-radius: 0 0 90px 90px;
            margin: 20px auto;
            position: relative;
            border: 3px solid #adb5bd;
        }

        .bowl-mixture {
            position: absolute;
            bottom: 10px;
            left: 50%;
            transform: translateX(-50%);
            width: 80%;
            height: 30px;
            background: #fdcb6e;
            border-radius: 0 0 70px 70px;
            transition: all 0.5s ease;
        }

        .flour-adding {
            margin: 20px 0;
        }

        .flour-scoop {
            font-size: 2rem;
            cursor: pointer;
            transition: all 0.3s ease;
            margin: 10px;
        }

        .flour-scoop:hover {
            transform: scale(1.2);
        }

        .flour-scoop.scooping {
            animation: scooping 0.5s ease-in-out;
        }

        @keyframes scooping {
            0%, 100% { transform: rotate(0deg); }
            50% { transform: rotate(-15deg); }
        }

        .dough-rolling {
            background: linear-gradient(145deg, #d2b48c, #daa520);
            border-radius: 15px;
            padding: 20px;
            margin: 20px 0;
            text-align: center;
            border: 3px solid #8b4513;
        }

        .dough-sheet {
            width: 200px;
            height: 150px;
            background: linear-gradient(145deg, #fff3cd, #ffeaa7);
            border-radius: 10px;
            margin: 20px auto;
            position: relative;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .dough-sheet:hover {
            transform: scale(1.05);
        }

        .cutting-lines {
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            display: none;
        }

        .cutting-lines.visible {
            display: block;
        }

        .cutting-line {
            position: absolute;
            background: #e17055;
            opacity: 0;
            animation: lineAppear 0.5s ease-out forwards;
        }

        .cutting-line.vertical {
            width: 2px;
            height: 100%;
            top: 0;
        }

        .cutting-line.horizontal {
            height: 2px;
            width: 100%;
            left: 0;
        }

        @keyframes lineAppear {
            from { opacity: 0; transform: scale(0); }
            to { opacity: 1; transform: scale(1); }
        }

        .dough-pieces {
            display: grid;
            grid-template-columns: repeat(6, 1fr);
            gap: 5px;
            margin: 20px 0;
            display: none;
        }

        .dough-pieces.visible {
            display: grid;
            animation: piecesAppear 1s ease-out;
        }

        @keyframes piecesAppear {
            from { opacity: 0; transform: scale(0); }
            to { opacity: 1; transform: scale(1); }
        }

        .dough-piece {
            width: 25px;
            height: 15px;
            background: linear-gradient(145deg, #fff3cd, #ffeaa7);
            border-radius: 3px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .dough-piece:hover {
            transform: scale(1.2);
        }

        .dough-piece.fried {
            background: linear-gradient(145deg, #d63031, #e17055);
            cursor: not-allowed;
        }

        .frying-station {
            text-align: center;
        }

        .oil-pot {
            width: 200px;
            height: 150px;
            background: linear-gradient(145deg, #2d3436, #636e72);
            border-radius: 20px;
            margin: 20px auto;
            position: relative;
            border: 5px solid #ddd;
        }

        .oil-surface {
            position: absolute;
            top: 30px;
            left: 20px;
            right: 20px;
            height: 80px;
            background: linear-gradient(145deg, #f39c12, #e67e22);
            border-radius: 10px;
            overflow: hidden;
        }

        .oil-surface.bubbling {
            animation: bubbling 1s ease-in-out infinite;
        }

        @keyframes bubbling {
            0%, 100% { background: linear-gradient(145deg, #f39c12, #e67e22); }
            50% { background: linear-gradient(145deg, #e67e22, #d35400); }
        }

        .frying-pieces {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            display: flex;
            flex-wrap: wrap;
            gap: 3px;
            justify-content: center;
            align-items: center;
        }

        .frying-piece {
            width: 12px;
            height: 8px;
            background: #fdcb6e;
            border-radius: 2px;
            animation: frying 2s ease-in-out infinite;
        }

        .frying-piece:nth-child(2) { animation-delay: 0.2s; }
        .frying-piece:nth-child(3) { animation-delay: 0.4s; }
        .frying-piece:nth-child(4) { animation-delay: 0.6s; }

        @keyframes frying {
            0%, 100% { transform: translateY(0) scale(1); background: #fdcb6e; }
            50% { transform: translateY(-5px) scale(1.1); background: #e17055; }
        }

        .honey-station {
            background: linear-gradient(145deg, #fff3cd, #ffeaa7);
            border-radius: 15px;
            padding: 20px;
            margin: 20px 0;
            text-align: center;
        }

        .honey-pot {
            width: 100px;
            height: 120px;
            background: linear-gradient(145deg, #f39c12, #e67e22);
            border-radius: 10px 10px 50px 50px;
            margin: 20px auto;
            position: relative;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .honey-pot:hover {
            transform: scale(1.05);
        }

        .honey-pot::before {
            content: 'üçØ';
            position: absolute;
            top: 10px;
            left: 50%;
            transform: translateX(-50%);
            font-size: 2rem;
        }

        .honey-drip {
            position: absolute;
            bottom: -20px;
            left: 50%;
            transform: translateX(-50%);
            width: 4px;
            height: 20px;
            background: #f39c12;
            border-radius: 0 0 2px 2px;
            display: none;
            animation: dripping 2s ease-in-out infinite;
        }

        .honey-drip.visible {
            display: block;
        }

        @keyframes dripping {
            0% { height: 0; }
            50% { height: 30px; }
            100% { height: 0; }
        }

        .sugar-pot {
            width: 80px;
            height: 80px;
            background: linear-gradient(145deg, #fff, #f8f9fa);
            border-radius: 10px;
            margin: 20px auto;
            position: relative;
            cursor: pointer;
            transition: all 0.3s ease;
            border: 2px solid #ddd;
        }

        .sugar-pot:hover {
            transform: scale(1.05);
        }

        .sugar-pot::before {
            content: 'üç¨';
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            font-size: 1.5rem;
        }

        .syrup-making {
            background: linear-gradient(145deg, #fd79a8, #e84393);
            color: white;
            padding: 20px;
            border-radius: 15px;
            margin: 20px 0;
            text-align: center;
        }

        .syrup-pot {
            width: 120px;
            height: 80px;
            background: linear-gradient(145deg, #2d3436, #636e72);
            border-radius: 10px;
            margin: 20px auto;
            position: relative;
            border: 3px solid #ddd;
        }

        .syrup-content {
            position: absolute;
            bottom: 10px;
            left: 50%;
            transform: translateX(-50%);
            width: 80%;
            height: 40px;
            background: linear-gradient(145deg, #f39c12, #e67e22);
            border-radius: 0 0 40px 40px;
        }

        .syrup-content.boiling {
            animation: syrupBoiling 1s ease-in-out infinite;
        }

        @keyframes syrupBoiling {
            0%, 100% { background: linear-gradient(145deg, #f39c12, #e67e22); }
            50% { background: linear-gradient(145deg, #e67e22, #d35400); }
        }

        .final-assembly {
            background: linear-gradient(145deg, #d4edda, #c3e6cb);
            border-radius: 15px;
            padding: 20px;
            margin: 20px 0;
            text-align: center;
        }

        .chak-chak-mold {
            width: 200px;
            height: 150px;
            background: linear-gradient(145deg, #e9ecef, #dee2e6);
            border-radius: 15px;
            margin: 20px auto;
            position: relative;
            border: 3px solid #adb5bd;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .chak-chak-mold:hover {
            transform: scale(1.05);
        }

        .chak-chak-pile {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            width: 80%;
            height: 60%;
            background: linear-gradient(145deg, #d63031, #e17055);
            border-radius: 10px;
            display: none;
        }

        .chak-chak-pile.visible {
            display: block;
            animation: pileGrow 2s ease-out;
        }

        @keyframes pileGrow {
            from { transform: translate(-50%, -50%) scale(0); }
            to { transform: translate(-50%, -50%) scale(1); }
        }

        .step-indicator {
            display: flex;
            justify-content: space-around;
            margin: 20px 0;
        }

        .indicator-step {
            text-align: center;
            padding: 10px;
            border-radius: 10px;
            background: #f8f9fa;
            transition: all 0.3s ease;
            flex: 1;
            margin: 0 5px;
        }

        .indicator-step.completed {
            background: linear-gradient(145deg, #00b894, #00cec9);
            color: white;
        }

        .indicator-step.active {
            background: linear-gradient(145deg, #f39c12, #e67e22);
            color: white;
        }

        @media (max-width: 768px) {
            .chak-chak-stages {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <div class="game-container">
        <div class="game-screen">
            <h1 class="screen-title">üçØ –ß–∞–∫-—á–∞–∫: –°–ª–∞–¥–∫–∏–π –¥–µ—Å–µ—Ä—Ç</h1>
            
            <div class="character-dialog">
                <div class="character-avatar">üëµüèª</div>
                <div class="dialog-text">
                    <p><strong>–ë–∞–±—É—à–∫–∞ –§–∞—Ç–∏–º–∞:</strong></p>
                    <p id="dialog-text">–¢–µ–ø–µ—Ä—å –ø—Ä–∏–≥–æ—Ç–æ–≤–∏–º —á–∞–∫-—á–∞–∫ - —Ç—Ä–∞–¥–∏—Ü–∏–æ–Ω–Ω—ã–π —Ç–∞—Ç–∞—Ä—Å–∫–∏–π –¥–µ—Å–µ—Ä—Ç! –°–Ω–∞—á–∞–ª–∞ —Ä–∞–∑–æ–±—å—ë–º —è–π—Ü–∞ –∏ –∑–∞–º–µ—Å–∏–º –∫—Ä—É—Ç–æ–µ —Ç–µ—Å—Ç–æ.</p>
                </div>
            </div>

            <div class="step-indicator">
                <div class="indicator-step active" id="step-dough">
                    <div>ü•ö</div>
                    <div>–¢–µ—Å—Ç–æ</div>
                </div>
                <div class="indicator-step" id="step-cutting">
                    <div>üî™</div>
                    <div>–ù–∞—Ä–µ–∑–∫–∞</div>
                </div>
                <div class="indicator-step" id="step-frying">
                    <div>üî•</div>
                    <div>–ñ–∞—Ä–∫–∞</div>
                </div>
                <div class="indicator-step" id="step-syrup">
                    <div>üçØ</div>
                    <div>–°–∏—Ä–æ–ø</div>
                </div>
                <div class="indicator-step" id="step-assembly">
                    <div>üèóÔ∏è</div>
                    <div>–°–±–æ—Ä–∫–∞</div>
                </div>
            </div>

            <div class="chak-chak-stages">
                <div class="stage-panel active" id="dough-stage">
                    <h3>ü•ö –ì–æ—Ç–æ–≤–∏–º —Ç–µ—Å—Ç–æ</h3>
                    <div class="dough-preparation">
                        <p>–†–∞–∑–±–µ–π 4 —è–π—Ü–∞ (–Ω–∞–∂–º–∏ –Ω–∞ –∫–∞–∂–¥–æ–µ):</p>
                        <div class="egg-cracking">
                            <div class="egg" onclick="crackEgg(1)"></div>
                            <div class="egg" onclick="crackEgg(2)"></div>
                            <div class="egg" onclick="crackEgg(3)"></div>
                            <div class="egg" onclick="crackEgg(4)"></div>
                        </div>
                        
                        <div class="mixing-bowl-chak">
                            <div class="bowl-mixture" id="bowl-mixture"></div>
                        </div>
                        
                        <div class="flour-adding">
                            <p>–î–æ–±–∞–≤—å –º—É–∫—É (–Ω–∞–∂–º–∏ 5 —Ä–∞–∑):</p>
                            <div class="flour-scoop" onclick="addFlour()">ü•Ñ</div>
                            <div id="flour-count">–î–æ–±–∞–≤–ª–µ–Ω–æ –º—É–∫–∏: 0/5</div>
                        </div>
                    </div>
                </div>

                <div class="stage-panel" id="cutting-stage">
                    <h3>üî™ –ù–∞—Ä–µ–∑–∞–µ–º —Ç–µ—Å—Ç–æ</h3>
                    <div class="dough-rolling">
                        <p>–ù–∞–∂–º–∏ –Ω–∞ —Ç–µ—Å—Ç–æ, —á—Ç–æ–±—ã —Ä–∞—Å–∫–∞—Ç–∞—Ç—å –∏ –Ω–∞—Ä–µ–∑–∞—Ç—å:</p>
                        <div class="dough-sheet" id="dough-sheet" onclick="rollAndCut()">
                            <div class="cutting-lines" id="cutting-lines">
                                <div class="cutting-line vertical" style="left: 33%;"></div>
                                <div class="cutting-line vertical" style="left: 66%;"></div>
                                <div class="cutting-line horizontal" style="top: 25%;"></div>
                                <div class="cutting-line horizontal" style="top: 50%;"></div>
                                <div class="cutting-line horizontal" style="top: 75%;"></div>
                            </div>
                        </div>
                        
                        <div class="dough-pieces" id="dough-pieces">
                            <!-- –ö—É—Å–æ—á–∫–∏ —Ç–µ—Å—Ç–∞ –±—É–¥—É—Ç –¥–æ–±–∞–≤–ª–µ–Ω—ã —á–µ—Ä–µ–∑ JavaScript -->
                        </div>
                    </div>
                </div>
            </div>

            <div class="stage-panel" id="frying-stage" style="display: none;">
                <h3>üî• –ñ–∞—Ä–∏–º –≤ –º–∞—Å–ª–µ</h3>
                <div class="frying-station">
                    <p>–ù–∞–∂–º–∏ –Ω–∞ –∫–∞—Å—Ç—Ä—é–ª—é, —á—Ç–æ–±—ã –ø–æ–∂–∞—Ä–∏—Ç—å –∫—É—Å–æ—á–∫–∏:</p>
                    <div class="oil-pot" onclick="startFrying()">
                        <div class="oil-surface" id="oil-surface">
                            <div class="frying-pieces" id="frying-pieces">
                                <div class="frying-piece"></div>
                                <div class="frying-piece"></div>
                                <div class="frying-piece"></div>
                                <div class="frying-piece"></div>
                            </div>
                        </div>
                    </div>
                    <div id="frying-instruction">–ö—É—Å–æ—á–∫–∏ –∂–∞—Ä—è—Ç—Å—è...</div>
                </div>
            </div>

            <div class="honey-station" id="honey-stage" style="display: none;">
                <h3>üçØ –ì–æ—Ç–æ–≤–∏–º –º–µ–¥–æ–≤—ã–π —Å–∏—Ä–æ–ø</h3>
                <div style="display: flex; justify-content: space-around; align-items: center;">
                    <div>
                        <p>–ú—ë–¥</p>
                        <div class="honey-pot" onclick="addHoney()">
                            <div class="honey-drip" id="honey-drip"></div>
                        </div>
                    </div>
                    <div style="font-size: 2rem;">+</div>
                    <div>
                        <p>–°–∞—Ö–∞—Ä</p>
                        <div class="sugar-pot" onclick="addSugar()"></div>
                    </div>
                </div>
                
                <div class="syrup-making" id="syrup-making" style="display: none;">
                    <h4>–í–∞—Ä–∏–º —Å–∏—Ä–æ–ø</h4>
                    <div class="syrup-pot">
                        <div class="syrup-content" id="syrup-content"></div>
                    </div>
                    <div id="syrup-instruction">–°–∏—Ä–æ–ø –≤–∞—Ä–∏—Ç—Å—è...</div>
                </div>
            </div>

            <div class="final-assembly" id="assembly-stage" style="display: none;">
                <h3>üèóÔ∏è –°–æ–±–∏—Ä–∞–µ–º —á–∞–∫-—á–∞–∫</h3>
                <p>–ù–∞–∂–º–∏ –Ω–∞ —Ñ–æ—Ä–º—É, —á—Ç–æ–±—ã —Å–æ–±—Ä–∞—Ç—å —á–∞–∫-—á–∞–∫:</p>
                <div class="chak-chak-mold" onclick="assembleChakChak()">
                    <div class="chak-chak-pile" id="chak-chak-pile"></div>
                </div>
                <div id="assembly-instruction">–°–º–µ—à–∞–π –∂–∞—Ä–µ–Ω—ã–µ –∫—É—Å–æ—á–∫–∏ —Å —Å–∏—Ä–æ–ø–æ–º</div>
            </div>

            <div class="dialog-controls">
                <button class="back-button" onclick="goBack()">–ù–∞–∑–∞–¥</button>
                <button class="next-button" id="next-button" onclick="goToNext('../pages/tatar-tea-prep.html')" style="display: none;">–ó–∞–≤–∞—Ä–∏—Ç—å —á–∞–π</button>
            </div>

            <div class="progress-bar">
                <div class="progress-fill" style="width: 75%;"></div>
            </div>
        </div>
    </div>
    
    <script src="../scripts/main.js"></script>
    <script>
        let currentStage = 'dough';
        let crackedEggs = 0;
        let flourAdded = 0;
        let isCut = false;
        let isFried = false;
        let honeyAdded = false;
        let sugarAdded = false;
        let syrupReady = false;
        
        function crackEgg(eggNumber) {
            const egg = event.target;
            if (egg.classList.contains('cracked')) return;
            
            egg.classList.add('cracked');
            crackedEggs++;
            
            // –û–±–Ω–æ–≤–ª—è–µ–º —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ –º–∏—Å–∫–∏
            updateBowlMixture();
            
            if (crackedEggs === 4) {
                document.getElementById('dialog-text').textContent = 
                    '–í—Å–µ —è–π—Ü–∞ —Ä–∞–∑–±–∏—Ç—ã! –¢–µ–ø–µ—Ä—å –¥–æ–±–∞–≤—å –º—É–∫—É –¥–ª—è –∫—Ä—É—Ç–æ–≥–æ —Ç–µ—Å—Ç–∞.';
            }
            
            playSound('crack');
        }
        
        function updateBowlMixture() {
            const bowlMixture = document.getElementById('bowl-mixture');
            const height = Math.min(crackedEggs * 8 + flourAdded * 5, 60);
            bowlMixture.style.height = height + 'px';
            
            if (flourAdded > 0) {
                bowlMixture.style.background = '#fff3cd';
            }
        }
        
        function addFlour() {
            if (crackedEggs < 4) {
                showMessage('–°–Ω–∞—á–∞–ª–∞ —Ä–∞–∑–±–µ–π –≤—Å–µ —è–π—Ü–∞!');
                return;
            }
            
            flourAdded++;
            
            const flourScoop = document.querySelector('.flour-scoop');
            flourScoop.classList.add('scooping');
            setTimeout(() => flourScoop.classList.remove('scooping'), 500);
            
            document.getElementById('flour-count').textContent = 
                `–î–æ–±–∞–≤–ª–µ–Ω–æ –º—É–∫–∏: ${flourAdded}/5`;
            
            updateBowlMixture();
            
            if (flourAdded >= 5) {
                setTimeout(() => {
                    completeDoughStage();
                }, 1000);
            }
            
            playSound('scoop');
        }
        
        function completeDoughStage() {
            document.getElementById('step-dough').classList.remove('active');
            document.getElementById('step-dough').classList.add('completed');
            document.getElementById('step-cutting').classList.add('active');
            
            document.getElementById('dough-stage').classList.remove('active');
            document.getElementById('cutting-stage').classList.add('active');
            
            document.getElementById('dialog-text').textContent = 
                '–¢–µ—Å—Ç–æ –≥–æ—Ç–æ–≤–æ! –¢–µ–ø–µ—Ä—å —Ä–∞—Å–∫–∞—Ç–∞–π –∏ –Ω–∞—Ä–µ–∂—å –µ–≥–æ –Ω–∞ –∫—É—Å–æ—á–∫–∏.';
            
            currentStage = 'cutting';
            showSuccessMessage('–¢–µ—Å—Ç–æ –≥–æ—Ç–æ–≤–æ!');
        }
        
        function rollAndCut() {
            if (currentStage !== 'cutting' || isCut) return;
            
            const cuttingLines = document.getElementById('cutting-lines');
            cuttingLines.classList.add('visible');
            
            setTimeout(() => {
                createDoughPieces();
                isCut = true;
                
                setTimeout(() => {
                    completeCuttingStage();
                }, 1000);
            }, 1500);
            
            playSound('cut');
        }
        
        function createDoughPieces() {
            const doughPieces = document.getElementById('dough-pieces');
            doughPieces.innerHTML = '';
            
            for (let i = 0; i < 24; i++) {
                const piece = document.createElement('div');
                piece.className = 'dough-piece';
                piece.onclick = () => selectPieceForFrying(piece);
                doughPieces.appendChild(piece);
            }
            
            doughPieces.classList.add('visible');
        }
        
        function selectPieceForFrying(piece) {
            if (currentStage !== 'frying') return;
            
            piece.classList.add('fried');
            
            // –ü—Ä–æ–≤–µ—Ä—è–µ–º, –≤—Å–µ –ª–∏ –∫—É—Å–æ—á–∫–∏ –ø–æ–∂–∞—Ä–µ–Ω—ã
            const allPieces = document.querySelectorAll('.dough-piece');
            const friedPieces = document.querySelectorAll('.dough-piece.fried');
            
            if (friedPieces.length === allPieces.length) {
                setTimeout(() => {
                    completeFryingStage();
                }, 1000);
            }
        }
        
        function completeCuttingStage() {
            document.getElementById('step-cutting').classList.remove('active');
            document.getElementById('step-cutting').classList.add('completed');
            document.getElementById('step-frying').classList.add('active');
            
            document.getElementById('cutting-stage').classList.remove('active');
            document.getElementById('frying-stage').style.display = 'block';
            
            document.getElementById('dialog-text').textContent = 
                '–ö—É—Å–æ—á–∫–∏ –Ω–∞—Ä–µ–∑–∞–Ω—ã! –¢–µ–ø–µ—Ä—å –ø–æ–∂–∞—Ä—å –∏—Ö –≤ –º–∞—Å–ª–µ.';
            
            currentStage = 'frying';
            showSuccessMessage('–¢–µ—Å—Ç–æ –Ω–∞—Ä–µ–∑–∞–Ω–æ!');
        }
        
        function startFrying() {
            if (currentStage !== 'frying' || isFried) return;
            
            const oilSurface = document.getElementById('oil-surface');
            oilSurface.classList.add('bubbling');
            
            document.getElementById('frying-instruction').textContent = 
                '–ù–∞–∂–∏–º–∞–π –Ω–∞ –∫—É—Å–æ—á–∫–∏ —Ç–µ—Å—Ç–∞, —á—Ç–æ–±—ã –ø–æ–∂–∞—Ä–∏—Ç—å –∏—Ö!';
            
            isFried = true;
            playSound('fry');
        }
        
        function completeFryingStage() {
            document.getElementById('step-frying').classList.remove('active');
            document.getElementById('step-frying').classList.add('completed');
            document.getElementById('step-syrup').classList.add('active');
            
            document.getElementById('frying-stage').style.display = 'none';
            document.getElementById('honey-stage').style.display = 'block';
            
            document.getElementById('dialog-text').textContent = 
                '–í—Å–µ –∫—É—Å–æ—á–∫–∏ –ø–æ–∂–∞—Ä–µ–Ω—ã! –¢–µ–ø–µ—Ä—å –ø—Ä–∏–≥–æ—Ç–æ–≤–∏–º –º–µ–¥–æ–≤—ã–π —Å–∏—Ä–æ–ø.';
            
            currentStage = 'syrup';
            showSuccessMessage('–ö—É—Å–æ—á–∫–∏ –ø–æ–∂–∞—Ä–µ–Ω—ã!');
        }
        
        function addHoney() {
            if (honeyAdded) return;
            
            honeyAdded = true;
            const honeyDrip = document.getElementById('honey-drip');
            honeyDrip.classList.add('visible');
            
            checkSyrupIngredients();
            playSound('pour');
        }
        
        function addSugar() {
            if (sugarAdded) return;
            
            sugarAdded = true;
            event.target.style.background = 'linear-gradient(145deg, #fdcb6e, #f39c12)';
            
            checkSyrupIngredients();
            playSound('pour');
        }
        
        function checkSyrupIngredients() {
            if (honeyAdded && sugarAdded) {
                document.getElementById('syrup-making').style.display = 'block';
                
                const syrupContent = document.getElementById('syrup-content');
                syrupContent.classList.add('boiling');
                
                setTimeout(() => {
                    completeSyrupStage();
                }, 3000);
            }
        }
        
        function completeSyrupStage() {
            document.getElementById('step-syrup').classList.remove('active');
            document.getElementById('step-syrup').classList.add('completed');
            document.getElementById('step-assembly').classList.add('active');
            
            document.getElementById('honey-stage').style.display = 'none';
            document.getElementById('assembly-stage').style.display = 'block';
            
            document.getElementById('dialog-text').textContent = 
                '–°–∏—Ä–æ–ø –≥–æ—Ç–æ–≤! –¢–µ–ø–µ—Ä—å —Å–æ–±–µ—Ä–∏ —á–∞–∫-—á–∞–∫.';
            
            currentStage = 'assembly';
            syrupReady = true;
            showSuccessMessage('–ú–µ–¥–æ–≤—ã–π —Å–∏—Ä–æ–ø –≥–æ—Ç–æ–≤!');
        }
        
        function assembleChakChak() {
            if (currentStage !== 'assembly' || !syrupReady) return;
            
            const chakChakPile = document.getElementById('chak-chak-pile');
            chakChakPile.classList.add('visible');
            
            document.getElementById('assembly-instruction').textContent = 
                '–ß–∞–∫-—á–∞–∫ –≥–æ—Ç–æ–≤!';
            
            setTimeout(() => {
                completeChakChakStage();
            }, 2000);
            
            playSound('assemble');
        }
        
        function completeChakChakStage() {
            document.getElementById('step-assembly').classList.remove('active');
            document.getElementById('step-assembly').classList.add('completed');
            
            document.getElementById('next-button').style.display = 'block';
            document.getElementById('dialog-text').textContent = 
                '–ó–∞–º–µ—á–∞—Ç–µ–ª—å–Ω–æ! –ß–∞–∫-—á–∞–∫ –≥–æ—Ç–æ–≤. –¢–µ–ø–µ—Ä—å –∑–∞–≤–∞—Ä–∏–º —Ç—Ä–∞–¥–∏—Ü–∏–æ–Ω–Ω—ã–π —Ç–∞—Ç–∞—Ä—Å–∫–∏–π —á–∞–π!';
        }
        
        function goBack() {
            window.location.href = '../pages/kystybyi-prep.html';
        }
        
        function goToNext(nextPage) {
            window.location.href = nextPage;
        }
    </script>
</body>
</html>